(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{673:function(e,t,r){"use strict";r.r(t);var n=r(175),c=r(514),l=r(512),o=r(650),m=r(527),d=r(530),f=r(657),h=r(659),v=r(658),j=r(656),k=r(140),E=r(526),O=r(560),y=r(655),w=(r(7),r(8),r(10),r(11),r(2)),_=r(4),x=(r(20),r(74),r(75),r(49),r(42),r(6),r(28),r(37));function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){Object(w.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P={name:"Email",layout:"admin",data:function(){return{copied:!1,saving:!1,usersToEmail:[],usersForEmail:[],allChecked:!0,subject:"",email:""}},fetch:function(){var e=this;return Object(_.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.listAllUsers();case 2:e.mapUsers(),e.usersForEmail=e.users;case 4:case"end":return t.stop()}}),t)})))()},computed:T(T({},Object(x.c)("admin",["users"])),{},{allEmailAddresses:function(){return this.users.map((function(e){return e.email})).toString()}}),methods:T(T(T({},Object(x.b)("admin",["listAllUsers"])),Object(x.b)("snackbar",["snack"])),{},{all:function(){this.allChecked?this.mapUsers():this.usersToEmail=[]},mapUsers:function(){this.usersToEmail=this.users.map((function(e){return e.id}))},doCopy:function(){var e=this;this.copied=!0,this.$refs.emails.focus(),document.execCommand("copy"),setTimeout((function(){e.copied=!1}),3e3)},sendEmail:function(){var e=this;return Object(_.a)(regeneratorRuntime.mark((function t(){var r,i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.saving=!0,r=20,i=0;case 3:if(!(i<e.usersToEmail.length)){t.next=12;break}return n=e.usersToEmail.slice(i,i+r),t.next=7,e.$sendEmail(n.reduce((function(t,r){return t.push(e.usersForEmail.filter((function(e){return e.id===r}))[0].email),t}),[]).toString(),e.subject,e.email);case 7:200!==t.sent.status&&e.error(n);case 9:i+=r,t.next=3;break;case 12:e.snack({message:"Your message was successfully sent to "+e.usersToEmail.length+" users."}),e.subject=null,e.email=null,e.saving=!1;case 16:case"end":return t.stop()}}),t)})))()},error:function(e){this.snack({message:"There was an issue sending emails to this group: "+e,color:"error"})}})},S=r(45),component=Object(S.a)(P,(function(){var e=this,t=e._self._c;return t(d.a,[t(c.a,[t(l.b,[t("h3",[e._v("Email")])]),e._v(" "),t(l.a,[t(O.a,{attrs:{placeholder:"Subject",outlined:"",label:"Subject"},model:{value:e.subject,callback:function(t){e.subject=t},expression:"subject"}}),e._v(" "),t(y.a,{attrs:{cols:"12",md:"6",placeholder:"Email",outlined:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1)],1),e._v(" "),t(E.a,[t(m.a,{attrs:{cols:"4"}},[t(O.a,{ref:"emails",attrs:{value:e.allEmailAddresses,readonly:""},on:{focus:function(e){return e.target.select()}}})],1),e._v(" "),t(m.a,{staticClass:"d-flex align-center",attrs:{cols:"1"}},[t(n.a,{on:{click:e.doCopy}},[t(k.a,[e._v("mdi-content-copy")])],1)],1),e.copied?t(m.a,{staticClass:"d-flex align-center ma-0 pa-0",attrs:{cols:"2"}},[e._v("Copied!")]):e._e()],1),e._v(" "),t(j.a,{attrs:{accordion:""}},[t(f.a,[t(v.a,[e._v("\n        Users ("+e._s(e.usersToEmail.length)+")\n      ")]),e._v(" "),t(h.a,[t(o.a,{attrs:{label:"Check/Uncheck All"},on:{click:e.all},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}}),e._v(" "),t(d.a,{staticClass:"d-flex justify-center flex-wrap"},e._l(e.usersForEmail,(function(r){return t(m.a,{key:r.id,staticClass:"lg-3 xs-12"},[t(o.a,{attrs:{id:r.id,label:"".concat(r.firstName," ").concat(r.lastName),value:r.id},model:{value:e.usersToEmail,callback:function(t){e.usersToEmail=t},expression:"usersToEmail"}})],1)})),1)],1)],1)],1),e._v(" "),t(m.a,{staticClass:"text-right",attrs:{cols:"12"}},[t("NuxtLink",{staticClass:"mr-2",attrs:{to:"/forgotPassword"}},[e._v("Cancel")]),e._v(" "),t(n.a,{attrs:{color:"primary",disabled:e.saving,small:""},on:{click:e.sendEmail}},[e._v("Send")])],1)],1)}),[],!1,null,"0b479858",null);t.default=component.exports}}]);